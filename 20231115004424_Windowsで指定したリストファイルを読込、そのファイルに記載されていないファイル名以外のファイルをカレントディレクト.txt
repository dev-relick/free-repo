Windowsで指定したリストファイルを読込、そのファイルに記載されていないファイル名以外のファイルをカレントディレクトリ配下から再帰的に探し出してoutput.txtというファイルに、フルパスでファイル名を出力するバッチファイルを出力してください


以下は、指定されたリストファイルに記載されていないファイルを探し出してフルパスで `output.txt` に出力するバッチファイルの例です。このスクリプトはリストファイルの名前を `list.txt` と仮定します。`list.txt` はカレントディレクトリに存在し、各行に除外するファイルの名前（パターン）が記載されているとします。

保存する前に、`list.txt` の名前を実際に使用するファイルの名前に適宜変更してください。

```batch
@echo off
setlocal EnableDelayedExpansion

:: リストファイルのパスを設定
set "LIST_FILE=list.txt"

:: 出力ファイルのパスを設定
set "OUTPUT_FILE=output.txt"

:: 出力ファイルがすでに存在する場合は削除
if exist "%OUTPUT_FILE%" del "%OUTPUT_FILE%"

:: 一時ファイルを作成してリストファイルの内容を格納
set "TEMPFILE=exclude.tmp"
type nul > "%TEMPFILE%"
for /f "delims=" %%i in (%LIST_FILE%) do (
 echo %%i>> "%TEMPFILE%"
)

:: カレントディレクトリ以下の全ファイルを再帰的に検索
for /r %%f in (*) do (
 set "exclude=false"
 for /f "delims=" %%p in (%TEMPFILE%) do (
 if "%%~nxf"=="%%p" set "exclude=true"
 )
 if !exclude! == false (
 echo %%f >> "%OUTPUT_FILE%"
 )
)

:: 一時ファイルを削除
if exist "%TEMPFILE%" del "%TEMPFILE%"

:: 終了
endlocal
echo 出力ファイルが生成されました: %CD%\%OUTPUT_FILE%
```

このバッチファイルを使用すると、カレントディレクトリ以下を再帰的に検索し、`list.txt` ファイルに記載されていないすべてのファイルが `output.txt` にフルパスで出力されます。

スクリプトの動作：
1. リストファイルの名前を指定します（この例では `list.txt` というファイル名）。
2. 出力ファイル `output.txt` が既に存在する場合は削除します。
3. リストファイルの各行を一時ファイルに移します。
4. カレントディレクトリから全ファイルを再帰的に検索します。
5. 各ファイル名が一時ファイル内の除外リストに含まれていないことを確認します。
6. 条件を満たすファイルのフルパスを出力ファイルに追記します。
7. 最後に一時ファイルを削除します。

実行する前に、カレントディレクトリに `list.txt` と出力ファイル `output.txt` が存在することを確認し、バッチファイルの拡張子を `.bat` とし、カレントディレクトリに保存してからバッチファイルを実行してください。

注意点として、このバッチファイルはファイル名の完全一致のみを考慮しており、パターンマッチングやワイルドカードはサポートされていません。また、ファイル名の大文字小文字は区別されません。これをパターンマッチングに対応させたり、大文字小文字を区別するようにしたい場合はさらに複雑なロジックを実装する必要があります。

{ "id": "chatcmpl-8L1KAEooYJdpC8TBb7OQ05d6FgKYS", "object": "chat.completion", "created": 1700020670, "model": "gpt-4-1106-preview", "choices": [ { "index": 0, "message": { "role": "assistant", "content": "以下は、指定したリストファイルを読み込み、記載されていないファイルをカレントディレクトリのclassesフォルダ配下から再帰的に探し出して削除し、その後空のフォルダを削除するVBScriptのサンプルコードです。このスクリプトでは、`preserveListFilePath` という変数に保護するファイルリストのパスを設定し、そこに記載されているファイルを除く、その他のファイルを削除します。\n\n```vbscript\nOption Explicit\n\nDim fso, preserveListFilePath, preserveFilesList, classesFolderPath\n\n' 保護するファイルリストのパス\npreserveListFilePath = \"preserve_list.txt\"\n\n' classesフォルダのパス\nclassesFolderPath = \"classes\"\n\n' Scripting.FileSystemObjectオブジェクトの生成\nSet fso = CreateObject(\"Scripting.FileSystemObject\")\n\n' 保護するファイルをコレクションにロード\npreserveFilesList = LoadPreserveFilesList(preserveListFilePath)\n\n' 指定パス配下でレシピに存在しないファイルを削除\nDeleteUnspecifiedFiles classesFolderPath, preserveFilesList\n\n' 空のフォルダを削除\nRemoveEmptyFolders classesFolderPath\n\n' オブジェクトの後処理\nSet fso = Nothing\n\n' 保護するファイルリストをロードする関数\nFunction LoadPreserveFilesList(filePath)\n Dim file, line, collection\n Set collection = CreateObject(\"Scripting.Dictionary\")\n If fso.FileExists(filePath) Then\n Set file = fso.OpenTextFile(filePath, 1)\n While Not file.AtEndOfStream\n line = file.ReadLine\n If Not collection.Exists(line) Then\n collection.Add line, True\n End If\n Wend\n file.Close\n End If\n Set LoadPreserveFilesList = collection\nEnd Function\n\n' 指定したパス配下でレシピにないファイルを削除する関数\nSub DeleteUnspecifiedFiles(folderPath, preserveList)\n Dim folder, file, subFolder\n Set folder = fso.GetFolder(folderPath)\n For Each file In folder.Files\n If Not preserveList.Exists(fso.BuildPath(folder.Path, file.Name)) Then\n fso.DeleteFile(file.Path)\n End If\n Next\n For Each subFolder In folder.SubFolders\n DeleteUnspecifiedFiles(subFolder.Path, preserveList)\n Next\nEnd Sub\n\n' 指定パス内の空のフォルダを削除する関数\nSub RemoveEmptyFolders(folderPath)\n Dim folder, subFolder\n Set folder = fso.GetFolder(folderPath)\n For Each subFolder In folder.SubFolders\n RemoveEmptyFolders(subFolder.Path)\n If subFolder.Files.Count = 0 And subFolder.SubFolders.Count = 0 Then\n subFolder.Delete\n End If\n Next\nEnd Sub\n```\n\n上記のVBScriptでは`LoadPreserveFilesList`関数でリストファイルを読み込み、`DeleteUnspecifiedFiles`関数で指定されていないファイルを削除し、`RemoveEmptyFolders`関数を使用して空のフォルダを削除しています。\n\nスクリプトを使用する前に、`preserveListFilePath`変数をあなたの保護するファイルリストに合わせて変更してください。また、スクリプトを使用する際には予期しない削除が発生しないよう十分に注意してください。削除の操作は元に戻せないため、特に重要なファイルが削除される前にバックアップを取ることを強くお勧めします。" }, "finish_reason": "stop" } ], "usage": { "prompt_tokens": 116, "completion_tokens": 940, "total_tokens": 1056 }, "system_fingerprint": "fp_a24b4d720c" }

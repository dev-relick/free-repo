Windowsで指定したリストファイルを読込、そのファイルに記載されていないファイル名以外のファイルをカレントディレクトリ配下から再帰的に探し出してoutput.txtというファイルに、フルパスでファイル名を出力するバッチファイルを出力してください


以下のバッチファイルスクリプトは、指示されたタスクを実行するためのものです。このスクリプトは、`list.txt` という名前のリストファイルを読み込み、そのファイル内にないファイル名を持つファイルをカレントディレクトリから再帰的に検索し、見つけたファイルのフルパスを `output.txt` に出力します。リストファイルの名前は `list.txt` である必要があります。もし別の名前を使用する場合は、バッチファイル内で記載されたファイル名を変更してください。

```batch
@echo off
setlocal enabledelayedexpansion

:: リストファイルのパスを指定
set "listFile=list.txt"
:: アウトプットファイルのパスを指定
set "outputFile=output.txt"

:: 出力ファイルを初期化
if exist "%outputFile%" del "%outputFile%"

:: ファイルリストを連想配列に格納
for /f "delims=" %%i in (%listFile%) do (
 set "fileList[%%i]=1"
)

:: カレントディレクトリ配下を再帰的に検索
for /r %%a in (*) do (
 set "filePath=%%a"
 set "fileName=%%~nxa"
 :: ファイル名がリストに含まれていないか確認
 if not defined fileList[!fileName!] (
 echo !filePath! >> "%outputFile%"
 )
)

echo Finished.
endlocal
```

これを新しいテキストファイルにコピーアンドペーストし、拡張子を `.bat` に変更してバッチファイルとして保存してください（例: `find_exclude_files.bat`）。保存したバッチファイルをカレントディレクトリに置き、`list.txt` ファイルが同じディレクトリにあることを確認してからバッチファイルを実行します。

`list.txt` には対象外にしたいファイル名を1行に1つずつ記載します。バッチファイルはカレントディレクトリ以下のすべてのフォルダを再帰的に検索し、リストファイルに存在しないファイルを `output.txt` にフルパスで出力します。

なお、このスクリプトは基本的なバッチファイルスクリプトです。大量のファイルやディレクトリがある場合、バッチファイルの実行速度は遅くなるかもしれません。また、`list.txt` 内で大文字小文字の区別を無視する場合、追加のコードが必要です。またファイル名のみをリストファイルに記載し、パス情報を含んでいないため、異なるディレクトリにある同名のファイルは区別されません。
